#Jan400_analysis

set.dir(input=/mnt/EXT/Schloss-data/Janssen/Janssen_data/data/mothur/Jan400, output=/mnt/EXT/Schloss-data/Janssen/Janssen_data/data/mothur/Jan400)

sub.sample(shared=Jan400.an.shared, count=Jan400.trim.contigs.good.unique.good.filter.unique.precluster.denovo.uchime.pick.pick.pick.count_table, size=3000)

#Analysis

#alpha diversity
summary.single(shared=Jan400.an.shared, calc=nseqs-coverage-sobs-invsimpson, subsample=T)

#beta diversity
dist.shared(shared=Jan400.an.shared, calc=thetayc-jclass, subsample=T)

#clustering different?
unifrac.weighted(tree=Jan400.an.thetayc.0.03.lt.ave.tre, group=Jan400.visit_responsewk22.design, random=T)

#plot
nmds(phylip=Jan400.an.thetayc.0.03.lt.ave.dist)
nmds(phylip=Jan400.an.thetayc.0.03.lt.ave.dist, mindim=3, maxdim=3)

#tests whether the centers of the clouds representing a group are more separated than the variation among samples of the same treatment
amova(phylip=Jan400.an.thetayc.0.03.lt.ave.dist, design=Jan400.visit_response22.design)

#significant difference in the variation of groups
homova(phylip=Jan400.an.thetayc.0.03.lt.ave.dist, design=Jan400.visit_responsewk22.design)

#which OTUs are responsible for shifting the samples along the two axes
corr.axes(axes=Jan400.an.thetayc.0.03.lt.ave.nmds.axes, shared=Jan400.an.0.03.subsample.shared, method=spearman, numaxes=3)

#see whether our data can be partitioned in to separate community types
get.communitytype(shared=Jan400.an.0.03.subsample.shared)

#determines whether there are any OTUs that are differentially represented between the samples
metastats(shared=Jan400.an.0.03.subsample.shared, design=Jan400.visit_responsewk22.design)

lefse(shared=Jan400.an.0.03.subsample.shared, design=Jan400.visit_responsewk22.design)

#identifying taxa that are responsible for differences between groupings
indicator(shared=Jan400.an.0.03.subsample.shared, design=Jan400.visit_responsewk22.design)

#which features (i.e. OTUs) are useful in discriminating between the two groups
classify.rf(shared=Jan400.an.0.03.subsample.shared, design=Jan400.RESPONSE.design)