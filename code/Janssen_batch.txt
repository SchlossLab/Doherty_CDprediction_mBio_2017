#make.contigs(file=All_Runs.files, processors=8)
#summary.seqs(fasta=All_Runs.trim.contigs.fasta)

screen.seqs(fasta=All_Runs.trim.contigs.fasta, group=All_Runs.contigs.groups, summary=All_Runs.trim.contigs.summary, maxambig=0, maxlength=275, processors=8)
summary.seqs(fasta=All_Runs.trim.contigs.good.fasta)
unique.seqs(fasta=All_Runs.trim.contigs.good.fasta)
count.seqs(name=All_Runs.trim.contigs.good.names, group=All_Runs.contigs.good.groups)
summary.seqs(count=All_Runs.trim.contigs.good.count_table)
pcr.seqs(fasta=silva.bacteria.fasta, start=11894, end=25319, keepdots=F, processors=8)
system(mv silva.bacteria.pcr.fasta silva.v4.fasta)
align.seqs(fasta=All_Runs.trim.contigs.good.unique.fasta, reference=silva.v4.fasta)
summary.seqs(fasta=All_Runs.trim.contigs.good.unique.align, count=All_Runs.trim.contigs.good.count_table)
screen.seqs(fasta=All_Runs.trim.contigs.good.unique.align, count=All_Runs.trim.contigs.good.count_table, summary=All_Runs.trim.contigs.good.unique.summary, start=1968, end=11550, maxhomop=8)
summary.seqs(fasta=current, count=current)
filter.seqs(fasta=All_Runs.trim.contigs.good.unique.good.align, vertical=T, trump=.)
unique.seqs(fasta=All_Runs.trim.contigs.good.unique.good.filter.fasta, count=All_Runs.trim.contigs.good.good.count_table)
pre.cluster(fasta=All_Runs.trim.contigs.good.unique.good.filter.unique.fasta, count=All_Runs.trim.contigs.good.unique.good.filter.count_table, diffs=2)
chimera.uchime(fasta=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.fasta, count=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.count_table, dereplicate=t)
remove.seqs(fasta=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.fasta, accnos=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.denovo.uchime.accnos)
summary.seqs(fasta=current, count=current) 
classify.seqs(fasta=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.pick.fasta, count=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.denovo.uchime.pick.count_table, reference=trainset14_032015.pds.fasta, taxonomy=trainset14_032015.pds.tax, cutoff=80, processors=8)
remove.lineage(fasta=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.pick.fasta, count=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.denovo.uchime.pick.count_table, taxonomy=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.pick.pds.wang.taxonomy, taxon=Chloroplast-Mitochondria-unknown-Archaea-Eukaryota)
cluster.split(fasta=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.pick.pick.fasta, count=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.denovo.uchime.pick.pick.count_table, taxonomy=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.pick.pds.wang.pick.taxonomy, splitmethod=classify, taxlevel=4, cutoff=0.15)
make.shared(list=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.pick.pick.an.unique_list.list, count=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.denovo.uchime.pick.pick.count_table, label=0.03)
classify.otu(list=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.pick.pick.an.unique_list.list, count=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.denovo.uchime.pick.pick.count_table, taxonomy=All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.pick.pds.wang.pick.taxonomy, label=0.03)
system(mv All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.pick.pick.an.unique_list.shared All_Runs.an.shared)
system(mv All_Runs.trim.contigs.good.unique.good.filter.unique.precluster.pick.pick.an.unique_list.0.03.cons.taxonomy All_Runs.an.cons.taxonomy)
count.groups(shared=All_Runs.an.shared)
#sub.sample(shared=All_Runs.an.shared)

#Analysis

#summary.single(shared=All_Runs.an.shared, calc=nseqs-coverage-sobs-invsimpson, subsample=T)
#heatmap.bin(shared=All_Runs.an.0.03.subsample.shared, scale=log2, numotu=50)
dist.shared(shared=All_Runs.an.shared, calc=thetayc-jclass, subsample=T)
#tree.shared(phylip=All_Runs.an.thetayc.0.03.lt.ave.dist)
#parsimony(tree=All_Runs.an.thetayc.0.03.lt.ave.tre, group=All_Runs.well.design,  groups=all)
pcoa(phylip=All_Runs.an.thetayc.0.03.lt.ave.dist)
#amova(phylip=All_Runs.an.thetayc.0.03.lt.ave.dist, design=All_Runs.well.design)